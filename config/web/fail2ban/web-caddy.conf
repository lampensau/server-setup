# Fail2ban Configuration for Caddy Web Server
# Protects against common web attacks and abuse

[caddy-404]
enabled = true
port = http,https
filter = caddy-404
logpath = /var/log/caddy/access.log
maxretry = 10
bantime = 3600
findtime = 600
action = iptables-multiport[name=caddy-404, port="http,https", protocol=tcp]

[caddy-badbots]
enabled = true
port = http,https
filter = caddy-badbots
logpath = /var/log/caddy/access.log
maxretry = 2
bantime = 86400
findtime = 600
action = iptables-multiport[name=caddy-badbots, port="http,https", protocol=tcp]

[caddy-dos]
enabled = true
port = http,https
filter = caddy-dos
logpath = /var/log/caddy/access.log
maxretry = 60
bantime = 600
findtime = 60
action = iptables-multiport[name=caddy-dos, port="http,https", protocol=tcp]

[caddy-auth]
enabled = true
port = http,https
filter = caddy-auth
logpath = /var/log/caddy/access.log
maxretry = 3
bantime = 3600
findtime = 600
action = iptables-multiport[name=caddy-auth, port="http,https", protocol=tcp]

[caddy-exploit]
enabled = true
port = http,https
filter = caddy-exploit
logpath = /var/log/caddy/access.log
maxretry = 1
bantime = 86400
findtime = 600
action = iptables-multiport[name=caddy-exploit, port="http,https", protocol=tcp]